<!doctype html><html lang="zh-Hant"><head><meta charset="UTF-8"><meta content="IE=edge" http-equiv="X-UA-Compatible"><meta content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,viewport-fit=cover,user-scalable=no" name="viewport"><title>Mifare UID Scanner</title><script src="https://www.googletagmanager.com/gtag/js?id=UA-39556213-3" async></script><script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","UA-39556213-3");</script><link href="https://cdn.jsdelivr.net/npm/animate.css@4/animate.min.css" rel="stylesheet"><link href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css" rel="stylesheet"><link href="https://cdn.jsdelivr.net/npm/font-awesome@4/css/font-awesome.min.css" rel="stylesheet"><link href="https://cdn.jsdelivr.net/npm/prismjs@1/themes/prism-tomorrow.min.css" rel="stylesheet"><link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;700&display=swap" rel="stylesheet"><meta content="Mifare UID Scanner" property="og:description"><meta content="zh_TW" property="og:locale"><meta content="Mifare UID Scanner" property="og:title"><meta content="website" property="og:type"><meta content="https://taichunmin.idv.tw/pn532.js/m1-uid-scanner.html" property="og:url"><style>[v-cloak]{display:none}.h1,.h2,.h3,.h4,.h5,.h6,body,h1,h2,h3,h4,h5,h6{font-family:"Noto Sans TC",sans-serif}.letter-spacing-n1px{letter-spacing:-1px}</style></head><body><div class="container my-3 text-monospace" id="app" v-cloak><h3 class="text-center mb-3">Mifare UID Scanner</h3><div class="form-group"><label>選擇 PN532 的連線方式</label><select class="form-control form-control-sm" v-model="h.adapter"><option value="ble">透過藍芽 BLE 連線 (支援 PC 及 Android)</option><option value="usb">透過 USB 連線 (支援 PC)</option></select></div><div class="mx-n1 row"><div class="col px-1"><button @click="btnClear" class="btn btn-block btn-danger" type="button">清空資料</button></div><div class="col px-1"><button @click="btnScanStart" class="btn btn-block btn-success" type="button" v-if="!scanning">開始掃描</button><button @click="btnScanStop" class="btn btn-block btn-warning" type="button" v-else>停止掃描</button></div></div><div class="letter-spacing-n1px mt-3 table-responsive" style="font-size:.85rem"><table class="text-center table table-bordered table-sm table-striped"><caption class="text-right"><small>點選表格可以複製資料</small></caption><thead><tr><th>掃描時間</th><th>UID</th><th>ATQA</th><th>SAK</th></tr></thead><tbody><tr :class="card.ts + 1000 > tsnow ? 'animate__animated animate__flash' : ''" :key="`${card.uid}-${card.atqa}-${card.sak}`" v-for="card in h.cards"><td>{{ dayjs(card.ts).format('YYYY-MM-DD HH:mm:ss') }}</td><td @click="btnCopy(card.uid)">{{ card.uid }}</td><td @click="btnCopy(card.atqa)">{{ card.atqa }}</td><td @click="btnCopy(card.sak)">{{ card.sak }}</td></tr></tbody></table></div></div><script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/dayjs@1/dayjs.min.js" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/json5@2/dist/index.min.js" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/lodash@4/lodash.min.js" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/papaparse@5/papaparse.min.js" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/popper.js@1/dist/umd/popper.min.js" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/prismjs@1/components/prism-core.min.js" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/prismjs@1/plugins/autoloader/prism-autoloader.min.js" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/qs@6/dist/qs.min.js" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/sweetalert2@11" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/vue@2/dist/vue.min.js" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.min.js" crossorigin="anonymous"></script><script src="https://taichunmin.idv.tw/pn532.js/pn532.min.js" crossorigin="anonymous"></script><script src="https://taichunmin.idv.tw/pn532.js/Crypto1.min.js" crossorigin="anonymous"></script><script src="https://taichunmin.idv.tw/pn532.js/plugin/Hf14a.min.js" crossorigin="anonymous"></script><script src="https://taichunmin.idv.tw/pn532.js/plugin/LoggerRxTx.min.js" crossorigin="anonymous"></script><script src="https://taichunmin.idv.tw/pn532.js/plugin/WebbleAdapter.min.js" crossorigin="anonymous"></script><script src="https://taichunmin.idv.tw/pn532.js/plugin/WebserialAdapter.min.js" crossorigin="anonymous"></script><script>const{Pn532:{Pn532,Packet,utils:Pn532utils},Pn532Hf14a,Pn532LoggerRxTx,Pn532WebbleAdapter,Pn532WebserialAdapter}=window,pn532usb=new Pn532,pn532ble=(pn532usb.use(new Pn532WebserialAdapter),pn532usb.use(new Pn532Hf14a),new Pn532);pn532ble.use(new Pn532WebbleAdapter),pn532ble.use(new Pn532Hf14a),new URL(location).searchParams.has("debug")&&(pn532usb.use(new Pn532LoggerRxTx),pn532ble.use(new Pn532LoggerRxTx)),window.vm=new Vue({el:"#app",data:{scanning:!1,tsnow:Date.now(),h:{adapter:"ble",cards:[]}},async mounted(){try{var e=JSON5.parse(localStorage.getItem(location.pathname));e&&this.$set(this,"h",{...this.h,...e})}catch(e){}this.$watch("h",()=>{localStorage.setItem(location.pathname,JSON5.stringify(this.h))},{deep:!0})},computed:{pn532(){return"usb"===this.h.adapter?pn532usb:pn532ble}},methods:{async btnScanStart(){try{this.showLoading("請稍候","連線到讀卡機");var e=await this.pn532.getFirmwareVersion();for(console.log("version = "+JSON.stringify(e)),this.scanning=!0,Swal.close();this.scanning;){try{var t,n=await this.pn532.$hf14a.mfSelectCard({timeout:1e3});n&&(t=_.uniqBy([{uid:n.uid.hex,atqa:n.atqa.hex,sak:n.sak.hex,ts:Date.now()},...this.h.cards],e=>`${e.uid}-${e.atqa}-`+e.sak),this.$set(this.h,"cards",t))}catch(e){if(!this.pn532.$adapter?.isOpen?.())throw e}this.tsnow=Date.now(),await Pn532utils.sleep(100)}Swal.close()}catch(e){console.error(e),this.scanning=!1,await Swal.fire({icon:"error",title:"掃描失敗",text:e.message})}},async btnScanStop(){this.showLoading("請稍候","正在停止掃描"),this.scanning=!1},async btnClear(){this.$set(this.h,"cards",[])},async btnCopy(e,t=null){t=t||document.body;var n=document.createElement("textarea");n.value=e,t.appendChild(n),n.select(),n.setSelectionRange(0,1e6),document.execCommand("copy"),t.removeChild(n),await Swal.fire({icon:"success",title:"複製成功"})},showLoading(e,t){Swal.fire({title:e,text:t,allowOutsideClick:!1,showConfirmButton:!1,willOpen:()=>{Swal.showLoading()}})}}});</script></body></html>