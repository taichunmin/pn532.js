<!doctype html><html lang="zh-Hant"><head><meta charset="UTF-8"><meta content="IE=edge" http-equiv="X-UA-Compatible"><meta content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,viewport-fit=cover,user-scalable=no" name="viewport"><title>Key Detector (北方智能卡)</title><script src="https://www.googletagmanager.com/gtag/js?id=UA-39556213-3" async></script><script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","UA-39556213-3");</script><link href="https://cdn.jsdelivr.net/npm/animate.css@4/animate.min.css" rel="stylesheet"><link href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css" rel="stylesheet"><link href="https://cdn.jsdelivr.net/npm/font-awesome@4/css/font-awesome.min.css" rel="stylesheet"><link href="https://cdn.jsdelivr.net/npm/prismjs@1/themes/prism-tomorrow.min.css" rel="stylesheet"><link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;700&display=swap" rel="stylesheet"><meta content="Key Detector (北方智能卡)" property="og:description"><meta content="zh_TW" property="og:locale"><meta content="Key Detector (北方智能卡)" property="og:title"><meta content="website" property="og:type"><meta content="https://taichunmin.idv.tw/pn532.js/detector-shop143630998.html" property="og:url"><style>[v-cloak]{display:none}.h1,.h2,.h3,.h4,.h5,.h6,body,h1,h2,h3,h4,h5,h6{font-family:"Noto Sans TC",sans-serif}.letter-spacing-n1px{letter-spacing:-1px}.input-group-prepend>.input-group-text{width:85px}</style></head><body><div class="container my-3 text-monospace" id="app" v-cloak><h4 class="mb-3 text-center">Key Detector (北方智能卡)</h4><div class="form-group"><label>選擇 PN532 的連線方式</label><select class="form-control form-control-sm" v-model="h.adapter"><option value="ble">透過藍芽 BLE 連線 (支援 PC 及 Android)</option><option value="usb">透過 USB 連線 (支援 PC)</option></select></div><div class="mb-3 card"><div class="card-header"><i class="fa fa-fw fa-id-card"></i> 讀取或模擬卡片</div><div class="card-body"><div class="input-group input-group-sm mb-2"><div class="input-group-prepend"><span class="input-group-text justify-content-center">卡片類型</span></div><select class="form-control form-control-sm" v-model="h.type"><option value="0">S50CL1 (1k, 4 bytes UID)</option><option value="1">S70CL1 (4k, 4 bytes UID)</option></select></div><div class="input-group input-group-sm mb-2 was-validated"><div class="input-group-prepend"><span class="input-group-text justify-content-center">UID</span></div><input class="form-control" required pattern="[\dA-Fa-f]{8}" v-model="h.uid" placeholder="請輸入 8 位數 16 進位的 UID"><div class="input-group-append"><button @click="h.uid = ''" class="btn btn-outline-danger" type="button">清空</button></div></div><div class="mx-n1 row"><div class="col px-1"><button @click="btnReadDetector" class="btn btn-block btn-success"><i class="fa fa-fw fa-sign-out"></i> 讀取卡號</button></div><div class="col px-1"><button @click="btnSetDetector" class="btn btn-block btn-primary"><i class="fa fa-fw fa-sign-in"></i> 模擬卡號</button></div></div></div></div><div class="mb-3 card"><div class="card-header"><i class="fa fa-fw fa-lock"></i> 破解金鑰或測試讀取</div><div class="card-body"><div class="input-group input-group-sm mb-2 was-validated"><div class="input-group-prepend"><span class="input-group-text justify-content-center">Block</span></div><input class="form-control" required max="63" min="0" type="number" v-model.number="h.block"><div class="input-group-append"><span class="input-group-text">Sector {{ (h?.block ?? 0) >>> 2 }}</span></div></div><div class="input-group input-group-sm mb-2"><div class="input-group-prepend"><span class="input-group-text justify-content-center">KEY類型</span></div><select class="form-control form-control-sm" v-model.number="h.isKb"><option value="0">Key A</option><option value="1">Key B</option></select></div><div class="input-group input-group-sm mb-2 was-validated"><div class="input-group-prepend"><span class="input-group-text justify-content-center">KEY</span></div><input class="form-control" required pattern="[\dA-Fa-f]{12}" v-model="h.key"><div class="input-group-append"><button @click="h.key" class="btn btn-outline-success" type="button">複製</button></div></div><div class="mx-n1 row"><div class="col px-1"><button @click="btnMfkey32v2" class="btn btn-block btn-success"><i class="fa fa-fw fa-key"></i> 破解金鑰</button></div><div class="col px-1"><button @click="btnReadBlock" class="btn btn-block btn-primary"><i class="fa fa-fw fa-unlock-alt"></i> 測試讀取</button></div></div></div></div><div class="mb-3 card"><div class="card-header"><i class="fa fa-fw fa-book"></i> 使用教學及購買連結</div><div class="card-body"><small><p>請先把原卡放在 PN532 上，按下「讀取卡號」來取得原卡的卡號，然後把原卡移開並把「單卡嗅探王」放到 PN532 上，按下「模擬卡號」來設定卡號。模擬完成後，請把「單卡嗅探王」拿去門禁讀卡機刷卡三次以上，然後再把「單卡嗅探王」放在 PN532 上，按下「破解金鑰」應該就可以取得金鑰了。</p><p>開發者所取得的「單卡嗅探王」硬體，能夠記錄 2 次刷卡記錄，如果已經記錄過 2 次刷卡記錄，你就需要把「單卡嗅探王」放到 PN532 上，再次按下「模擬卡號」按鈕才能重新記錄。</p><p>如果沒有辦法成功使用這種方式取得卡片金鑰，代表讀卡機有針對此種攻擊方式進行防範，這時候你會需要側錄讀卡機與原卡的通訊資料才能破解金鑰。</p></small><div class="mx-n1 row mt-2"><div class="col px-1"><a class="btn btn-block btn-outline-secondary" href="https://shop143630998.world.taobao.com/" target="_blank"><i class="fa fa-fw fa-shopping-cart"></i> 店舖頁面</a></div><div class="col px-1"><a class="btn btn-block btn-outline-secondary" href="https://lihi1.com/MAU73" target="_blank"><i class="fa fa-fw fa-tag"></i> 購買網頁</a></div></div><button @click="btnReset" class="btn btn-block btn-danger mt-2"><i class="fa fa-repeat mr-2"></i> 重設資料</button></div></div></div><script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/dayjs@1/dayjs.min.js" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/json5@2/dist/index.min.js" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/lodash@4/lodash.min.js" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/papaparse@5/papaparse.min.js" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/popper.js@1/dist/umd/popper.min.js" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/prismjs@1/components/prism-core.min.js" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/prismjs@1/plugins/autoloader/prism-autoloader.min.js" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/qs@6/dist/qs.min.js" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/sweetalert2@11" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/vue@2/dist/vue.min.js" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.min.js" crossorigin="anonymous"></script><script src="https://taichunmin.idv.tw/pn532.js/pn532.min.js" crossorigin="anonymous"></script><script src="https://taichunmin.idv.tw/pn532.js/Crypto1.min.js" crossorigin="anonymous"></script><script src="https://taichunmin.idv.tw/pn532.js/plugin/Hf14a.min.js" crossorigin="anonymous"></script><script src="https://taichunmin.idv.tw/pn532.js/plugin/LoggerRxTx.min.js" crossorigin="anonymous"></script><script src="https://taichunmin.idv.tw/pn532.js/plugin/WebbleAdapter.min.js" crossorigin="anonymous"></script><script src="https://taichunmin.idv.tw/pn532.js/plugin/WebserialAdapter.min.js" crossorigin="anonymous"></script><script>const{Pn532:{Pn532,Packet,utils:Pn532utils},Crypto1,Pn532Hf14a,Pn532LoggerRxTx,Pn532WebbleAdapter,Pn532WebserialAdapter}=window,pn532usb=new Pn532,pn532ble=(pn532usb.use(new Pn532WebserialAdapter),pn532usb.use(new Pn532Hf14a),new Pn532);pn532ble.use(new Pn532WebbleAdapter),pn532ble.use(new Pn532Hf14a),new URL(location).searchParams.has("debug")&&(pn532usb.use(new Pn532LoggerRxTx),pn532ble.use(new Pn532LoggerRxTx)),window.vm=new Vue({el:"#app",data:{h:{adapter:"ble",block:3,isKb:0,key:"FFFFFFFFFFFF",type:0,uid:"01020304"}},async mounted(){try{var e=JSON5.parse(localStorage.getItem(location.pathname));e&&this.$set(this,"h",{...this.h,...e})}catch(e){}this.$watch("h",()=>{localStorage.setItem(location.pathname,JSON5.stringify(this.h))},{deep:!0})},computed:{pn532(){return"usb"===this.h.adapter?pn532usb:pn532ble}},methods:{async btnReadDetector(){try{this.showLoading("正在讀卡...","若耗時過久請重新整理網頁。");var e=await this.pn532.$hf14a.mfSelectCard();this.h.uid=e.uid.hex,this.h.type=+("0002"===e.atqa.hex&&"18"===e.sak.hex),Swal.close()}catch(e){console.error(e),await Swal.fire({icon:"error",title:"讀卡失敗",text:e.message})}},async btnSetDetector(){var e=this["pn532"];try{var t=Packet.fromHex(this.h.uid);if(!Packet.isLen(t,4))throw new TypeError("卡號 uid 有誤");this.showLoading("正在模擬...","若耗時過久請重新整理網頁。");try{await e.$hf14a.inListPassiveTarget(),await e.inSelect({tg:1}),await e.inCommunicateThru({data:Packet.fromHex("E000")}),await e.inCommunicateThru({data:new Packet([...Packet.fromHex("0A0000AE010201"),...t,this.h.type])}),await e.inCommunicateThru({data:Packet.fromHex("0B0000AE01030100")})}finally{e?.$adapter?.isOpen?.()&&await e.inRelease().catch(()=>{})}var a=await this.pn532.$hf14a.mfSelectCard();if(!a)throw new Error("模擬後讀取不到卡片");if(a.uid.hex!==this.h.uid)throw new Error("模擬後讀取到的 UID 錯誤");if(a.atqa.hex+"-"+a.sak.hex!=(this.h.type?"0002-18":"0004-08"))throw new Error("模擬後讀取到的 ATQA, SAK 錯誤");await Swal.fire({icon:"success",title:"模擬成功"})}catch(e){console.error(e),await Swal.fire({icon:"error",title:"模擬失敗",text:e.message})}},async btnReadBlock(){var e=this["pn532"];try{this.showLoading("正在測試...","若耗時過久請重新整理網頁。");var t=await e.$hf14a.mfReadBlock({block:this.h.block,isKb:this.h.isKb,key:Packet.fromHex(this.h.key)});console.log(t),await Swal.fire({icon:"success",title:"測試成功"})}catch(e){console.error(e),await Swal.fire({icon:"error",title:"測試失敗",text:e.message})}},async btnMfkey32v2(){var t=this["pn532"];try{this.showLoading("正在破解...","若耗時過久請重新整理網頁。");var a=[];let e;try{e=_.first(await t.$hf14a.inListPassiveTarget()),await t.inSelect({tg:1}),await t.inCommunicateThru({data:Packet.fromHex("E000")});var i=(await t.inCommunicateThru({data:Packet.fromHex("0A0000AE000300")}))["data"];if(i[2]<2)throw new Error("刷卡次數不夠。請先模擬卡號、刷卡三次以上、然後按下破解金鑰按鈕。");for(let e=0;e<2;e++){var n=Packet.fromHex(["0B0000AE000000","0A0000AE000100"][e]),r=(await t.inCommunicateThru({data:n}))["data"];a.push({block:r[3],sector:r[3]>>>2,isKb:+(97===r[2]),nt:0,nr:r.subarray(4,8),ar:r.subarray(8,12)})}}finally{t?.$adapter?.isOpen?.()&&await t.inRelease().catch(()=>{})}if(a[0].sector!==a[1].sector)throw new Error("兩次刷卡記錄的區塊不同");if(a[0].isKb!==a[1].isKb)throw new Error("兩次刷卡記錄的金鑰類型不同");this.showLoading("正在破解...","正在計算金鑰"),_.assign(this.h,{block:a[0].block,isKb:a[0].isKb,key:this.mfkey32v2(e.uid,a[0],a[1])}),await Swal.fire({icon:"success",title:"破解成功"})}catch(e){console.error(e),await Swal.fire({icon:"error",title:"破解失敗",text:e.message})}},mfkey32v2(e,t,a){return Crypto1.mfkey32v2({uid:e,nt0:t.nt,nr0:t.nr,ar0:t.ar,nt1:a.nt,nr1:a.nr,ar1:a.ar}).hex},async btnCopy(e,t=null){t=t||document.body;var a=document.createElement("textarea");a.value=e,t.appendChild(a),a.select(),a.setSelectionRange(0,1e6),document.execCommand("copy"),t.removeChild(a),await Swal.fire({icon:"success",title:"複製成功"})},async btnReset(){if(await this.confirm("是否重設資料？（此動作無法還原）","確定","取消"))return this.showLoading("重設資料中...","重設後將自動重新整理網頁。"),localStorage.removeItem(location.pathname),location.reload(),new Promise(e=>{})},async confirm(e,t,a){return(await Swal.fire({cancelButtonColor:"#3085d6",cancelButtonText:a,confirmButtonColor:"#d33",confirmButtonText:t,focusCancel:!0,icon:"warning",showCancelButton:!0,text:e}))?.isConfirmed},showLoading(e,t){Swal.fire({title:e,text:t,allowOutsideClick:!1,showConfirmButton:!1,willOpen:()=>{Swal.showLoading()}})}}});</script></body></html>